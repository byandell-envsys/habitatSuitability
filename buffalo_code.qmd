---
title: "hist"
format:
  html:
    code-fold: true
---

```{python}
import sys
print(sys.executable)
print(sys.version)
```

## Create Buffalo GeoDataFrame

```{python}
import os # Interoperable file paths
import pathlib # Find the home folder
import geopandas as gpd # read geojson file into gdf
from landmapy.redline import plot_redline # plot gdf
```

```{python}
# Define and create the project data directory
data_dir = os.path.join(
    pathlib.Path.home(),
    'earth-analytics', 'data','habitat'
)
os.makedirs(data_dir, exist_ok=True)
data_dir
```

```{python}
grassland_url = f"{data_dir}/National_Grassland_Units_(Feature_Layer).geojson"
print(grassland_url)
grassland_gdf = gpd.read_file(grassland_url)
```

```{python}
buffalo_gdf = grassland_gdf.loc[grassland_gdf['GRASSLANDNAME'].isin(
    ["Buffalo Gap National Grassland", "Oglala National Grassland"])]
plot_redline(buffalo_gdf)
```

## Soil and Climate Measures

### Sand Soil Measurement

```{python}
from landmapy.habitat import merge_soil
from landmapy.index import gdf_over_da
```

Merge soil tiles to create `buffalo_da`.
This takes some time.

```{python}
print(buffalo_gdf.total_bounds)
buffalo_da = merge_soil(buffalo_gdf)
```

```{python}
buffalo_gdf['color'] = ['white','red']
gdf_over_da(buffalo_gdf, buffalo_da, cmap='viridis')
```

### Climate Precipitation Measure

```{python}
from landmapy.habitat import process_maca, maca_year
from landmapy.index import gdf_over_da
```

```{python}
maca_df = process_maca({'buffalo': buffalo_gdf})
maca_df[['site_name', 'scenario', 'climate', 'year']]
```

```{python}
maca_2027_year_da = maca_year(maca_df, 0, 2027) # 0 = `rcp85`, 1 = `rcp45`
gdf_over_da(buffalo_gdf, maca_2027_year_da)
```
